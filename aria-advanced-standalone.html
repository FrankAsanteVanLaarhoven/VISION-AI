<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ARIA - Complete AI Assistant Suite</title>
    <script type="importmap">
      {
        "imports": {
          "@splinetool/runtime": "https://unpkg.com/@splinetool/runtime@1.6.2/build/runtime.js",
          "three": "https://unpkg.com/three@0.155.0/build/three.module.js",
          "three/addons/": "https://unpkg.com/three@0.155.0/examples/jsm/"
        }
      }
    </script>
    <style>
        :root {
            /* Light Theme */
            --background: #ffffff;
            --foreground: #000000;
            --card: #f8f9fa;
            --border: #e9ecef;
            --accent: #000000;
            --text-light: #6c757d;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
        }

        [data-theme="dark"] {
            /* Dark Theme */
            --background: #000000;
            --foreground: #ffffff;
            --card: #1a1a1a;
            --border: #333333;
            --accent: #ffffff;
            --text-light: #adb5bd;
            --success: #28a745;
            --warning: #ffc107;
            --danger: #dc3545;
            --info: #17a2b8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #0f0f23, #1a1a2e, #16213e);
            color: white;
            line-height: 1.6;
            transition: all 0.3s ease;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 10px;
        }

        .header {
            text-align: center;
            padding: 20px 0;
            background: var(--card);
            border-radius: 15px;
            margin-bottom: 20px;
            border: 2px solid var(--border);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--foreground);
            margin-bottom: 8px;
        }

        .header p {
            font-size: 1rem;
            color: var(--text-light);
            max-width: 800px;
            margin: 0 auto;
        }

        .theme-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .theme-btn {
            padding: 10px 20px;
            background: var(--accent);
            color: var(--background);
            border: 2px solid var(--border);
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .theme-btn:hover {
            background: var(--foreground);
            color: var(--background);
        }

        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1000;
            padding: 10px 20px;
            background: var(--accent);
            color: var(--background);
            border: 2px solid var(--border);
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .back-btn:hover {
            background: var(--foreground);
            color: var(--background);
        }

        /* ARIA Mode Selector removed for full-screen lifelike view */

        /* ARIA Mode Content */
        .aria-mode-content {
            display: none;
        }

        .aria-mode-content.active {
            display: block;
        }

        /* Simple Chat Mode */
        .aria-simple-container {
            background: var(--card);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid var(--border);
        }

        .aria-simple-chat {
            max-width: 800px;
            margin: 0 auto;
        }

        .aria-simple-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .aria-simple-header h3 {
            font-size: 1.5rem;
            color: var(--foreground);
            margin-bottom: 10px;
        }

        .aria-simple-header p {
            color: var(--text-light);
        }

        .aria-simple-messages {
            height: 400px;
            overflow-y: auto;
            background: var(--background);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 2px solid var(--border);
        }

        .aria-simple-message {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: flex-start;
        }

        .aria-simple-message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .message-content {
            background: var(--card);
            padding: 15px 20px;
            border-radius: 15px;
            border: 2px solid var(--border);
            max-width: 70%;
            color: var(--foreground);
        }

        .aria-simple-message.user .message-content {
            background: var(--accent);
            color: var(--background);
        }

        .aria-simple-input {
            display: flex;
            gap: 10px;
        }

        .aria-simple-input input {
            flex: 1;
            padding: 15px 20px;
            border: 2px solid var(--border);
            border-radius: 25px;
            background: var(--background);
            color: var(--foreground);
            font-size: 1rem;
        }

        .aria-simple-input button {
            padding: 15px 30px;
            background: var(--accent);
            color: var(--background);
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .aria-simple-input button:hover {
            background: var(--foreground);
            transform: translateY(-2px);
        }

        /* Typing indicator styles */
        .typing-content {
            display: flex;
            align-items: center;
            min-height: 20px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dots span {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--accent);
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dots span:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1);
                opacity: 1;
            }
        }

        /* Robot Demo Mode */
        .aria-robot-demo-container {
            background: var(--card);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid var(--border);
        }

        .aria-robot-demo-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .aria-robot-demo-header h3 {
            font-size: 1.5rem;
            color: var(--foreground);
            margin-bottom: 10px;
        }

        .aria-robot-demo-header p {
            color: var(--text-light);
        }

        .aria-robot-demo-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .robot-control-group {
            background: var(--background);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid var(--border);
        }

        .robot-control-group h4 {
            color: var(--foreground);
            margin-bottom: 20px;
            font-size: 1.1rem;
        }

        .robot-movement {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .robot-btn {
            padding: 15px 20px;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 10px;
            color: var(--foreground);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .robot-btn:hover {
            background: var(--accent);
            color: var(--background);
            transform: translateY(-2px);
        }

        .robot-sensors {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .sensor-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background: var(--card);
            border-radius: 8px;
            border: 1px solid var(--border);
        }

        .sensor-label {
            color: var(--foreground);
            font-weight: 600;
        }

        .sensor-value {
            color: var(--success);
            font-weight: 600;
        }

        .robot-navigation {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        /* Face Recognition Mode */
        .aria-face-container {
            background: var(--card);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid var(--border);
        }

        .aria-face-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .aria-face-header h3 {
            font-size: 1.5rem;
            color: var(--foreground);
            margin-bottom: 10px;
        }

        .aria-face-header p {
            color: var(--text-light);
        }

        .aria-face-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .face-camera {
            background: var(--background);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid var(--border);
        }

        .face-camera-view {
            height: 300px;
            background: var(--card);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            border: 2px solid var(--border);
        }

        .face-camera-placeholder {
            color: var(--text-light);
            font-size: 1.2rem;
        }

        .face-controls {
            display: flex;
            gap: 10px;
        }

        .face-btn {
            flex: 1;
            padding: 12px 20px;
            background: var(--accent);
            color: var(--background);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .face-btn:hover {
            background: var(--foreground);
            transform: translateY(-2px);
        }

        .face-results {
            background: var(--background);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid var(--border);
        }

        .face-results h4 {
            color: var(--foreground);
            margin-bottom: 20px;
        }

        .face-results-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .face-result-item {
            display: flex;
            gap: 15px;
            align-items: center;
            padding: 15px;
            background: var(--card);
            border-radius: 10px;
            border: 1px solid var(--border);
        }

        .face-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .face-info {
            flex: 1;
        }

        .face-name {
            color: var(--foreground);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .face-confidence {
            color: var(--text-light);
            font-size: 0.9rem;
        }

        /* Advanced Mode */
        .aria-advanced-container {
            background: var(--card);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid var(--border);
        }

        .aria-advanced-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .aria-advanced-header h3 {
            font-size: 1.5rem;
            color: var(--foreground);
            margin-bottom: 10px;
        }

        .aria-advanced-header p {
            color: var(--text-light);
        }

        .advanced-feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .advanced-feature-card {
            background: var(--background);
            padding: 25px;
            border-radius: 15px;
            border: 2px solid var(--border);
            text-align: center;
            transition: all 0.3s ease;
        }

        .advanced-feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .advanced-feature-card h4 {
            color: var(--foreground);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .advanced-feature-card p {
            color: var(--text-light);
            margin-bottom: 20px;
            font-size: 0.9rem;
        }

        .feature-btn {
            padding: 10px 20px;
            background: var(--accent);
            color: var(--background);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .feature-btn:hover {
            background: var(--foreground);
            transform: translateY(-2px);
        }

        /* Lifelike Mode */
        .aria-lifelike-container {
            background: var(--card);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid var(--border);
        }

        .aria-lifelike-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .aria-lifelike-header h3 {
            font-size: 1.5rem;
            color: var(--foreground);
            margin-bottom: 10px;
        }

        .aria-lifelike-header p {
            color: var(--text-light);
        }

        .aria-avatar-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .aria-avatar {
            width: 150px;
            height: 150px;
            background: var(--background);
            border-radius: 50%;
            border: 4px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .aria-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .control-group {
            background: var(--background);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid var(--border);
        }

        .control-group h4 {
            color: var(--foreground);
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .emotion-controls, .action-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .emotion-btn, .action-btn {
            padding: 8px 16px;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 20px;
            color: var(--foreground);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .emotion-btn:hover, .action-btn:hover {
            background: var(--accent);
            color: var(--background);
            transform: translateY(-2px);
        }

        .emotion-btn.active {
            background: var(--accent);
            color: var(--background);
        }

        .voice-controls {
            display: flex;
            gap: 10px;
            margin-top: 12px;
        }

        .voice-btn {
            flex: 1;
            padding: 12px 20px;
            background: var(--accent);
            color: var(--background);
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .voice-btn:hover {
            background: var(--foreground);
            transform: translateY(-2px);
        }

        .voice-btn.danger {
            background: var(--danger);
        }

        .voice-btn.danger:hover {
            background: #c82333;
        }

        /* Lifelike Mode Specific Styles */
        .main-content {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .robot-container {
            background: rgba(0, 0, 0, 0.9);
            border-radius: 20px;
            overflow: visible;
            position: relative;
            min-height: 600px;
            height: auto;
            border: 2px solid rgba(59, 130, 246, 0.3);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
        }

        .avatar-canvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        .robot-overlay {
            position: relative;
            background: rgba(0, 0, 0, 0.85);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(59, 130, 246, 0.5);
            backdrop-filter: blur(15px);
            z-index: 10;
            margin: 20px;
            width: calc(100% - 40px);
            max-width: none;
            max-height: none;
            overflow: visible;
        }

        /* Inline two-column layout inside overlay */
        .overlay-sections { display: grid; grid-template-columns: 2fr 1fr; gap: 16px; }
        .overlay-main { display: flex; flex-direction: column; gap: 10px; }
        .overlay-side { background: rgba(0,0,0,0.6); border: 1px solid rgba(75,85,99,0.4); border-radius: 12px; padding: 10px; height: fit-content; position: sticky; top: 20px; }
        .side-card { background: rgba(17,24,39,0.7); border: 1px solid rgba(75,85,99,0.35); border-radius: 10px; padding: 10px; margin-bottom: 10px; }
        .side-title { font-size: 0.95rem; font-weight: 600; color: #e5e7eb; margin-bottom: 8px; }

        .assistant-info {
            margin-bottom: 15px;
        }

        .assistant-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #60a5fa;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .emotion-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #10b981;
            animation: emotion-pulse 2s infinite;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #10b981;
            animation: pulse 2s infinite;
        }

        .listening-dot {
            background: #f59e0b !important;
            animation: listening-pulse 0.5s infinite;
        }

        .speaking-dot {
            background: #8b5cf6 !important;
            animation: speaking-pulse 1s infinite;
        }

        .thinking-dot {
            background: #06b6d4 !important;
            animation: thinking-pulse 0.3s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.1); }
        }

        @keyframes listening-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.4); }
        }

        @keyframes speaking-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.2); }
        }

        @keyframes thinking-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            25% { opacity: 0.8; transform: scale(1.1); }
            50% { opacity: 0.6; transform: scale(1.2); }
            75% { opacity: 0.8; transform: scale(1.1); }
        }

        @keyframes emotion-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        .emotion-happy { background: #10b981 !important; }
        .emotion-curious { background: #06b6d4 !important; }
        .emotion-focused { background: #8b5cf6 !important; }
        .emotion-friendly { background: #f59e0b !important; }
        .emotion-surprised { background: #ef4444 !important; }
        .emotion-neutral { background: #6b7280 !important; }

        .conversation-display {
            max-height: 180px;
            overflow-y: auto;
            background: rgba(17, 24, 39, 0.8);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        /* Lifelike Chat Section */
        .lifelike-chat-section {
            background: rgba(17, 24, 39, 0.8);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        /* Chat actions inline under input */
        .chat-actions { display: flex; gap: 8px; margin-top: 10px; justify-content: flex-end; }
        .chat-action-btn { padding: 8px 16px; background: rgba(59,130,246,0.2); color: var(--foreground); border: 1px solid rgba(59,130,246,0.3); border-radius: 20px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
        .chat-action-btn:hover { background: rgba(59,130,246,0.35); transform: translateY(-1px); }
        .chat-action-btn.primary { background: var(--accent); color: var(--background); border: none; }

        /* System controls (compact) */
        .system-controls { background: rgba(17,24,39,0.8); border: 1px solid rgba(75,85,99,0.3); border-radius: 12px; padding: 10px; margin-bottom: 12px; }
        .sys-row { display: grid; grid-template-columns: repeat(4, minmax(140px, 1fr)); gap: 8px; }
        .sys-btn { padding: 8px 10px; background: rgba(59,130,246,0.2); color: var(--foreground); border: 1px solid rgba(59,130,246,0.3); border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.2s ease; }
        .sys-btn:hover { background: rgba(59,130,246,0.35); transform: translateY(-1px); }
        .sys-title { color: var(--foreground); font-weight: 600; margin: 0 0 8px 0; font-size: 0.95rem; }
        .analytics-chart { margin-top: 10px; background: rgba(0,0,0,0.3); border: 1px solid rgba(75,85,99,0.3); border-radius: 8px; padding: 8px; text-align: center; }

        .chat-header {
            text-align: center;
            margin-bottom: 15px;
        }

        .chat-header h4 {
            color: var(--foreground);
            margin: 0 0 5px 0;
            font-size: 1rem;
        }

        .chat-header p {
            color: #9ca3af;
            margin: 0;
            font-size: 0.8rem;
        }

        .lifelike-messages {
            max-height: 120px;
            overflow-y: auto;
            margin-bottom: 10px;
        }

        .lifelike-message {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
            align-items: flex-start;
        }

        .lifelike-message .message-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            flex-shrink: 0;
        }

        .lifelike-message .message-content {
            background: rgba(59, 130, 246, 0.2);
            color: #ffffff;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            max-width: 80%;
            word-wrap: break-word;
        }

        .lifelike-message.user .message-content {
            background: var(--accent);
            color: var(--background);
        }

        .lifelike-input {
            display: flex;
            gap: 8px;
        }

        .lifelike-input input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid var(--border);
            border-radius: 20px;
            background: var(--background);
            color: var(--foreground);
            font-size: 0.8rem;
        }

        .lifelike-input button {
            padding: 8px 16px;
            background: var(--accent);
            color: var(--background);
            border: none;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .lifelike-input button:hover {
            background: var(--foreground);
        }

        /* Lifelike Robot Demo */
        .lifelike-robot-demo {
            background: rgba(17, 24, 39, 0.8);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .robot-demo-header {
            text-align: center;
            margin-bottom: 15px;
        }

        .robot-demo-header h4 {
            color: var(--foreground);
            margin: 0 0 5px 0;
            font-size: 1rem;
        }

        .robot-demo-header p {
            color: #9ca3af;
            margin: 0;
            font-size: 0.8rem;
        }

        .movement-controls, .sensor-data, .navigation-status {
            margin-bottom: 15px;
        }

        .movement-controls h5, .sensor-data h5, .navigation-status h5 {
            color: var(--foreground);
            margin: 0 0 10px 0;
            font-size: 0.9rem;
        }

        .control-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .robot-btn {
            padding: 8px 12px;
            background: rgba(59, 130, 246, 0.2);
            color: var(--foreground);
            border: 1px solid rgba(59, 130, 246, 0.3);
            border-radius: 8px;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .robot-btn:hover {
            background: rgba(59, 130, 246, 0.4);
            transform: translateY(-1px);
        }

        .sensor-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .sensor-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 10px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
        }

        .sensor-label {
            color: var(--foreground);
            font-size: 0.8rem;
            font-weight: 500;
        }

        .sensor-status {
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 12px;
            font-weight: 500;
        }

        .sensor-status.processing {
            background: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }

        .sensor-status.analyzing {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }

        .sensor-status.calibrated {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }

        .nav-status {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        .nav-label {
            color: var(--foreground);
            font-size: 0.8rem;
            font-weight: 500;
        }

        .nav-value {
            color: #10b981;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* Enable page scrolling to access all features */
        html, body { height: auto; }
        body { overflow: auto; }

        /* Compact overrides (ensure these come after base styles) */
        .quick-controls-mini .tool-btn { padding: 6px 8px !important; font-size: 0.85rem !important; line-height: 1.1; }
        .quick-controls-mini .dropdown-toggle { width: auto !important; min-width: 220px; padding: 8px 10px !important; font-size: 0.9rem !important; }
        .quick-controls-mini .mini-row { grid-template-columns: repeat(2, minmax(140px, auto)) !important; }

        /* Lifelike Face Recognition */
        .lifelike-face-recognition {
            background: rgba(17, 24, 39, 0.8);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .face-header { text-align: center; margin-bottom: 12px; }
        .face-header h4 { color: var(--foreground); margin: 0 0 4px 0; font-size: 1rem; }
        .face-header p { color: #9ca3af; margin: 0; font-size: 0.8rem; }
        .face-grid { display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 12px; }
        .face-camera-embed { background: rgba(0,0,0,0.3); border-radius: 10px; padding: 10px; }
        .face-camera-placeholder { display:flex; align-items:center; justify-content:center; height:140px; color:#9ca3af; border:1px dashed rgba(255,255,255,0.1); border-radius:8px; }
        .face-controls-inline { display:flex; gap:8px; margin-top:8px; }
        .face-btn { padding:6px 10px; background: rgba(59,130,246,0.2); color: var(--foreground); border:1px solid rgba(59,130,246,0.3); border-radius:6px; font-size:0.75rem; cursor:pointer; }
        .face-btn:hover { background: rgba(59,130,246,0.4); }
        .face-results-embed { background: rgba(0,0,0,0.3); border-radius: 10px; padding: 10px; }
        .face-results-embed h5 { color: var(--foreground); margin:0 0 8px 0; font-size:0.9rem; }
        .face-results-list { display:flex; flex-direction:column; gap:8px; max-height:140px; overflow:auto; }
        .face-result-item { display:flex; gap:10px; align-items:center; background: rgba(255,255,255,0.03); padding:8px; border-radius:8px; }
        .face-avatar { font-size:1.2rem; }
        .face-info { color: var(--foreground); font-size:0.8rem; }
        .face-name { font-weight:600; }
        .face-confidence { color:#9ca3af; }

        /* Lifelike Advanced Features */
        .lifelike-advanced { background: rgba(17,24,39,0.8); border-radius:10px; padding:15px; margin-bottom:15px; }
        .advanced-header { text-align:center; margin-bottom:12px; }
        .advanced-header h4 { color: var(--foreground); margin:0 0 4px 0; font-size:1rem; }
        .advanced-header p { color:#9ca3af; margin:0; font-size:0.8rem; }
        .advanced-feature-grid.compact { grid-template-columns: repeat(4, minmax(160px, 1fr)); gap: 10px; }

        /* Legacy accordion styles removed (replaced by toolbar buttons) */

        /* Tool buttons (single compact section) */
        .lifelike-tools { background: rgba(17,24,39,0.85); border: 1px solid rgba(59,130,246,0.25); border-radius: 12px; padding: 10px; }
        .tool-buttons { display: grid; grid-template-columns: repeat(4, minmax(110px, 1fr)); gap: 8px; margin-bottom: 8px; }
        .tool-btn { padding: 8px 10px; border-radius: 8px; border: 1px solid rgba(75,85,99,0.3); background: rgba(55,65,81,0.6); color: #e5e7eb; font-weight: 600; cursor: pointer; }
        .tool-btn:hover { background: rgba(59,130,246,0.25); }
        .tool-btn.active { background: rgba(59,130,246,0.4); border-color: rgba(59,130,246,0.6); }
        .tool-content { background: rgba(2,6,23,0.6); border: 1px solid rgba(59,130,246,0.15); border-radius: 10px; padding: 8px; }
        .tool-pane { display: none; }
        .tool-pane.active { display: block; }

        .conversation-item {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .user-message {
            background: rgba(59, 130, 246, 0.2);
            border-left: 3px solid #3b82f6;
            text-align: right;
        }

        .assistant-message {
            background: rgba(168, 85, 247, 0.2);
            border-left: 3px solid #a855f7;
        }

        .animation-controls {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.85);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(75, 85, 99, 0.5);
            z-index: 10;
        }

        .animation-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #e5e7eb;
        }

        .emotion-controls {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .emotion-btn {
            padding: 4px 8px;
            background: rgba(55, 65, 81, 0.8);
            border: 1px solid rgba(75, 85, 99, 0.5);
            border-radius: 6px;
            color: #e5e7eb;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .emotion-btn:hover, .emotion-btn.active {
            background: rgba(59, 130, 246, 0.4);
            border-color: #3b82f6;
            color: #60a5fa;
        }

        .metrics-overlay {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.85);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(168, 85, 247, 0.5);
            backdrop-filter: blur(10px);
            z-index: 10;
            min-width: 130px;
        }

        .metric {
            text-align: center;
            margin-bottom: 12px;
        }

        .metric-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #10b981;
        }

        .metric-label {
            font-size: 0.8rem;
            color: #9ca3af;
        }

        .control-panel {
            background: rgba(17, 24, 39, 0.9);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(75, 85, 99, 0.3);
            height: fit-content;
            display: none; /* hidden in compact layout */
        }

        .control-section {
            margin-bottom: 25px;
        }

        .control-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #e5e7eb;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .voice-controls {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 10px;
            margin-bottom: 15px;
        }

        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .btn-outline {
            background: transparent;
            border: 2px solid #6b7280;
            color: #e5e7eb;
        }

        .voice-select {
            width: 100%;
            padding: 10px;
            border: 2px solid #374151;
            border-radius: 8px;
            background: rgba(31, 41, 55, 0.8);
            color: white;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .text-input {
            width: 100%;
            padding: 12px;
            border: 2px solid #374151;
            border-radius: 8px;
            background: rgba(31, 41, 55, 0.8);
            color: white;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .text-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .feature-btn {
            padding: 10px 12px;
            background: rgba(55, 65, 81, 0.6);
            border: 1px solid rgba(75, 85, 99, 0.3);
            border-radius: 8px;
            color: #e5e7eb;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .feature-btn:hover {
            background: rgba(59, 130, 246, 0.3);
            border-color: #3b82f6;
            transform: translateY(-1px);
        }

        /* Minimal dropdown menus */
        .dropdown { position: relative; }
        .dropdown-toggle {
            width: 100%;
            padding: 10px 12px;
            border-radius: 10px;
            border: 1px solid rgba(75,85,99,0.3);
            background: rgba(55,65,81,0.6);
            color: #e5e7eb;
            font-weight: 600;
            cursor: pointer;
            text-align: left;
        }
        .dropdown-toggle:hover { background: rgba(59,130,246,0.3); border-color: #3b82f6; }
        .dropdown-menu {
            display: none;
            position: relative;
            margin-top: 8px;
            background: rgba(2,6,23,0.8);
            border: 1px solid rgba(59,130,246,0.25);
            border-radius: 10px;
            padding: 6px;
            max-height: 220px;
            overflow-y: auto;
            z-index: 50;
        }
        .dropdown-menu.open { display: block; }
        .dropdown-item {
            width: 100%;
            padding: 8px 10px;
            border-radius: 8px;
            color: #e5e7eb;
            border: none;
            background: transparent;
            text-align: left;
            cursor: pointer;
        }
        .dropdown-item:hover { background: rgba(59,130,246,0.25); }

        /* Quick controls inside robot overlay */
        .quick-controls-mini { background: rgba(2,6,23,0.6); border: 1px solid rgba(59,130,246,0.2); border-radius: 12px; padding: 10px; margin-bottom: 10px; }
        .mini-row { display: grid; grid-template-columns: repeat(2, minmax(120px, 1fr)); gap: 8px; margin-bottom: 8px; }
        .quick-controls-mini .tool-btn { padding: 6px 8px; font-size: 0.9rem; line-height: 1.1; }
        .quick-controls-mini .dropdown-toggle { padding: 8px 10px; font-size: 0.9rem; }

        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            flex-direction: column;
            gap: 20px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(59, 130, 246, 0.3);
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Spline hero card (matches splite demo layout) */
        .spline-card {
            position: relative;
            width: 100%;
            height: 500px;
            background: rgba(0,0,0,0.96);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .spline-row {
            position: relative;
            display: flex;
            width: 100%;
            height: 100%;
        }

        .spline-left {
            flex: 1;
            padding: 32px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            z-index: 2;
        }

        .spline-left h1 {
            font-size: 2.25rem;
            font-weight: 800;
            background: linear-gradient(180deg, #ffffff, #d1d5db);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .spline-left p {
            margin-top: 12px;
            color: #d1d5db;
            max-width: 560px;
            line-height: 1.5;
        }

        .spline-right {
            flex: 1;
            position: relative;
        }

        #splineCanvas {
            position: absolute;
            inset: 0;
            width: 100%;
            height: 100%;
            display: block;
        }

        /* Spotlight hover effect */
        .spotlight {
            position: absolute;
            pointer-events: none;
            width: 240px;
            height: 240px;
            border-radius: 9999px;
            filter: blur(24px);
            background: radial-gradient(circle at center, rgba(250,250,250,0.9), rgba(229,229,229,0.6), rgba(212,212,212,0.3), transparent 80%);
            opacity: 0;
            transition: opacity 0.2s ease;
            z-index: 1;
        }

        .spline-card:hover .spotlight {
            opacity: 1;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }

            .robot-overlay, .animation-controls, .metrics-overlay {
                position: relative;
                max-width: none;
                margin-bottom: 15px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 5px;
            }
            
            .header {
                padding: 15px 0;
                margin-bottom: 15px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .aria-mode-selector {
                flex-direction: column;
                align-items: center;
                padding: 10px;
                margin-bottom: 15px;
            }
            
            .aria-face-content {
                grid-template-columns: 1fr;
            }
            
            .aria-robot-demo-controls {
                grid-template-columns: 1fr;
            }
            
            .aria-avatar {
                width: 120px;
                height: 120px;
                font-size: 2.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Theme Switcher -->
        <div class="theme-switcher">
            <button class="theme-btn" onclick="toggleTheme()">🌙 Dark</button>
        </div>

        <!-- Back Button -->
        <a href="/enhanced-dashboard.html" class="back-btn">← Back to Dashboard</a>

        <!-- Header -->
        <div class="header">
            <h1>🤖 ARIA - Complete AI Assistant Suite</h1>
            <p>Privacy-Preserving Vision-Language-Action Navigation with Quantum-Enhanced AI</p>
        </div>

        <!-- ARIA Mode Selector removed -->

        <!-- ARIA Main Content -->
        <div class="aria-main-content">
            <!-- Lifelike Mode -->
            <div id="aria-lifelike-mode" class="aria-mode-content active">
                <!-- Spline-styled hero card -->
                <div class="spline-card">
                    <div class="spotlight" id="spotlight"></div>
                    <div class="spline-row">
                        <div class="spline-left">
                            <h1>ARIA Lifelike AI Assistant</h1>
                            <p>Experience the future of human-robot interaction with ARIA, your advanced lifelike AI companion. Powered by quantum-enhanced perception and natural language understanding for seamless, intelligent assistance.</p>
                        </div>
                        <div class="spline-right">
                            <canvas id="splineCanvas"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Robot Container -->
                <div class="robot-container" id="robotContainer">
                    <!-- Loading State -->
                    <div class="loading" id="loadingState">
                        <div class="spinner"></div>
                        <p>Initializing Lifelike AI Avatar...</p>
                    </div>

                    <!-- 3D Avatar Canvas -->
                    <canvas class="avatar-canvas" id="avatarCanvas" style="display: none;"></canvas>

                    <!-- Robot Overlay -->
                    <div class="robot-overlay" id="robotOverlay">
                        <div class="assistant-info">
                            <div class="assistant-name" id="assistantName">
                                ARIA
                                <div class="emotion-indicator" id="emotionIndicator"></div>
                            </div>
                            <div style="font-size: 0.85rem; color: #9ca3af;">Lifelike AI Research Assistant</div>
                        </div>
                        
                        <div class="status-indicator">
                            <div class="status-dot" id="statusDot"></div>
                            <span id="robotStatus">Ready</span>
                        </div>

                        <!-- Mini quick controls moved into this section -->
                        <div class="overlay-sections">
                            <div class="overlay-main">
                                <div class="quick-controls-mini">
                                    <div class="mini-row" style="grid-template-columns: repeat(4, minmax(140px, auto));">
                                        <button class="tool-btn" id="mini-start">🎤 Start</button>
                                        <button class="tool-btn" id="mini-stop">🔇 Stop</button>
                                        <div class="dropdown">
                                            <button class="dropdown-toggle" data-dropdown="quickMenuInline">Choose Quick Interaction</button>
                                            <div class="dropdown-menu" id="quickMenuInline">
                                                <button class="dropdown-item" onclick="quickAsk('Hello ARIA!')">👋 Greet</button>
                                                <button class="dropdown-item" onclick="quickAsk('What time is it?')">⏰ Time</button>
                                                <button class="dropdown-item" onclick="quickAsk('How are you feeling?')">😊 Mood</button>
                                                <button class="dropdown-item" onclick="quickAsk('Tell me a joke')">😄 Joke</button>
                                                <button class="dropdown-item" onclick="quickAsk('Explain quantum physics')">🔬 Science</button>
                                                <button class="dropdown-item" onclick="quickAsk('Show excitement')">🎉 Excited</button>
                                                <button class="dropdown-item" onclick="quickAsk('Be curious about something')">🤔 Curious</button>
                                                <button class="dropdown-item" onclick="quickAsk('Take notes for me')">📝 Notes</button>
                                            </div>
                                        </div>
                                        <div class="dropdown">
                                            <button class="dropdown-toggle" data-dropdown="animMenuInline">Choose Animation</button>
                                            <div class="dropdown-menu" id="animMenuInline">
                                                <button class="dropdown-item" onclick="triggerAnimation('wave')">👋 Wave</button>
                                                <button class="dropdown-item" onclick="triggerAnimation('nod')">✅ Nod</button>
                                                <button class="dropdown-item" onclick="triggerAnimation('shake')">❌ Shake Head</button>
                                                <button class="dropdown-item" onclick="triggerAnimation('think')">🤔 Think</button>
                                                <button class="dropdown-item" onclick="triggerAnimation('point')">👉 Point</button>
                                                <button class="dropdown-item" onclick="triggerAnimation('shrug')">🤷 Shrug</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Single compact tools section -->
                                <div class="lifelike-tools" id="lifelikeTools">
                                    <div class="tool-buttons">
                                        <button class="tool-btn active" data-pane="#pane-chat">💬 Chat</button>
                                        <button class="tool-btn" data-pane="#pane-robot">🤖 Robot</button>
                                        <button class="tool-btn" data-pane="#pane-face">👤 Face</button>
                                        <button class="tool-btn" data-pane="#pane-advanced">⚡ Advanced</button>
                                    </div>
                                    <div class="tool-content">
                                        <div class="tool-pane active" id="pane-chat">
                                            <div class="lifelike-chat-section">
                                                <div class="system-controls">
                                                    <div class="sys-title">🛠️ System Controls</div>
                                                    <div class="sys-row" style="margin-bottom:8px;">
                                                        <button class="sys-btn" id="rc-start">Start Reality Engine</button>
                                                        <button class="sys-btn" id="rc-calibrate">Calibrate Sensors</button>
                                                        <button class="sys-btn" id="rc-update">Update Models</button>
                                                        <button class="sys-btn" id="rc-emergency">Emergency Stop</button>
                                                    </div>
                                                    <div class="sys-row" style="margin-bottom:8px;">
                                                        <button class="sys-btn" id="sc-start">Start Collaboration</button>
                                                        <button class="sys-btn" id="sc-monitor">Monitor Safety</button>
                                                        <button class="sys-btn" id="sc-optimize">Optimize Tasks</button>
                                                        <button class="sys-btn" id="sc-emergency">Supply Emergency</button>
                                                    </div>
                                                    <div class="sys-row" style="margin-bottom:8px;">
                                                        <button class="sys-btn" id="sp-activate">Activate Protection</button>
                                                        <button class="sys-btn" id="sp-scan">Security Scan</button>
                                                        <button class="sys-btn" id="sp-update">Update Policies</button>
                                                        <button class="sys-btn" id="sp-lockdown">System Lockdown</button>
                                                    </div>
                                                    <div class="sys-row">
                                                        <button class="sys-btn" id="analytics-run">Run Analytics</button>
                                                        <button class="sys-btn" id="status-refresh">Refresh Status</button>
                                                    </div>
                                                    <div class="analytics-chart" id="analytics-chart" style="display:none;"></div>
                                                </div>
                                                <div class="lifelike-messages" id="lifelike-messages">
                                                    <div class="lifelike-message assistant">
                                                        <div class="message-avatar">🤖</div>
                                                        <div class="message-content">Hello! I'm ARIA, your AI assistant. How can I help you today?</div>
                                                    </div>
                                                </div>
                                                <div class="lifelike-input">
                                                    <input type="text" id="lifelike-input" placeholder="Type your message...">
                                                    <button id="lifelike-send">Send</button>
                                                </div>
                                                <div class="chat-actions">
                                                    <button class="chat-action-btn" id="clearConversation">Clear Chat</button>
                                                    <button class="chat-action-btn primary" id="downloadTranscript">📝 Export</button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tool-pane" id="pane-robot">
                                            <div class="lifelike-robot-demo">
                                                <div class="movement-controls">
                                                    <h5>Movement Controls</h5>
                                                    <div class="control-grid">
                                                        <button class="robot-btn" data-action="forward">↑ Forward</button>
                                                        <button class="robot-btn" data-action="backward">↓ Backward</button>
                                                        <button class="robot-btn" data-action="left">← Left</button>
                                                        <button class="robot-btn" data-action="right">→ Right</button>
                                                        <button class="robot-btn" data-action="stop">⏹ Stop</button>
                                                    </div>
                                                </div>
                                                <div class="sensor-data">
                                                    <h5>Sensor Data</h5>
                                                    <div class="sensor-grid">
                                                        <div class="sensor-item"><span class="sensor-label">LiDAR:</span><span class="sensor-status processing" id="lidar-status">Processing</span></div>
                                                        <div class="sensor-item"><span class="sensor-label">Camera:</span><span class="sensor-status analyzing" id="camera-status">Analyzing</span></div>
                                                        <div class="sensor-item"><span class="sensor-label">IMU:</span><span class="sensor-status calibrated" id="imu-status">Calibrated</span></div>
                                                    </div>
                                                </div>
                                                <div class="navigation-status">
                                                    <h5>Navigation</h5>
                                                    <div class="nav-status"><span class="nav-label">Status:</span><span class="nav-value" id="nav-status">Ready</span></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tool-pane" id="pane-face">
                                            <div class="lifelike-face-recognition">
                                                <div class="face-grid">
                                                    <div class="face-camera-embed" id="lifelike-face-camera">
                                                        <div class="face-camera-placeholder">📹 Camera Feed</div>
                                                        <div class="face-controls-inline">
                                                            <button class="face-btn" id="lifelike-start-face">🔍 Start Recognition</button>
                                                            <button class="face-btn" id="lifelike-stop-face">⏹️ Stop Recognition</button>
                                                        </div>
                                                    </div>
                                                    <div class="face-results-embed">
                                                        <h5>Recognition Results</h5>
                                                        <div class="face-results-list" id="lifelike-face-results"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tool-pane" id="pane-advanced">
                                            <div class="lifelike-advanced">
                                                <div class="advanced-feature-grid compact">
                                                    <div class="advanced-feature-card"><div class="feature-icon">🧠</div><h4>Quantum Processing</h4><p>Advanced quantum-enhanced AI processing</p><button class="feature-btn" data-feature="quantum">Activate</button></div>
                                                    <div class="advanced-feature-card"><div class="feature-icon">🔒</div><h4>Privacy Protection</h4><p>Homomorphic encryption and privacy preservation</p><button class="feature-btn" data-feature="privacy">Enable</button></div>
                                                    <div class="advanced-feature-card"><div class="feature-icon">🌐</div><h4>Federated Learning</h4><p>Distributed learning across multiple nodes</p><button class="feature-btn" data-feature="federated">Start</button></div>
                                                    <div class="advanced-feature-card"><div class="feature-icon">🎯</div><h4>Precision Navigation</h4><p>Sub-millimeter navigation accuracy</p><button class="feature-btn" data-feature="navigation">Calibrate</button></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Side column: current emotion + metrics -->
                            <div class="overlay-side">
                                <div class="side-card">
                                    <div class="side-title">🎭 Current Emotion</div>
                                    <div class="emotion-controls">
                                        <button class="emotion-btn" onclick="setEmotion('happy')">😊 Happy</button>
                                        <button class="emotion-btn" onclick="setEmotion('curious')">🤔 Curious</button>
                                        <button class="emotion-btn" onclick="setEmotion('focused')">😐 Focused</button>
                                        <button class="emotion-btn" onclick="setEmotion('surprised')">😮 Surprised</button>
                                        <button class="emotion-btn active" onclick="setEmotion('neutral')">😌 Neutral</button>
                                    </div>
                                </div>
                                <div class="side-card">
                                    <div class="side-title">📈 Live Metrics</div>
                                    <div class="metric"><div class="metric-value" id="responseTimeMini">0.8s</div><div class="metric-label">Response</div></div>
                                    <div class="metric"><div class="metric-value" id="emotionStateMini">Friendly</div><div class="metric-label">Emotion</div></div>
                                    <div class="metric"><div class="metric-value" id="animationFPSMini">60fps</div><div class="metric-label">Animation</div></div>
                                    <div class="metric"><div class="metric-value" id="conversationsMini">0</div><div class="metric-label">Exchanges</div></div>
                                </div>
                            </div>
                        </div>

                        <!-- Duplicate lifelike-tools removed -->

                        <!-- Bottom duplicated actions removed (moved inline under input) -->
                    </div>

                    <!-- Animation Controls -->
                    <!-- Removed duplicate bottom Current Emotion panel -->

                    <!-- Metrics Overlay -->
                    <div class="metrics-overlay" id="metricsOverlay" style="display: none; visibility: hidden;">
                        <div class="metric">
                            <div class="metric-value" id="responseTime">0.8s</div>
                            <div class="metric-label">Response</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="emotionState">Neutral</div>
                            <div class="metric-label">Emotion</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="animationFPS">60fps</div>
                            <div class="metric-label">Animation</div>
                        </div>
                        <div class="metric">
                            <div class="metric-value" id="conversations">0</div>
                            <div class="metric-label">Exchanges</div>
                        </div>
                    </div>
                </div>

                <!-- Control Panel (hidden in compact full-width layout) -->
                <div class="control-panel" style="display: none;">
                    <!-- Avatar & Voice (minimized) -->
                    <!-- Removed from compact layout to save space -->

                    <!-- Voice Controls (compact buttons) -->
                    <div class="control-section">
                        <div class="tool-buttons" style="grid-template-columns: repeat(2, 1fr);">
                            <button class="tool-btn" id="btn-start-talk">🎤 Start</button>
                            <button class="tool-btn" id="btn-stop-talk">🔇 Stop</button>
                        </div>
                    </div>

                    <!-- Quick Actions (dropdown) -->
                    <div class="control-section">
                        <h3 class="control-title">⚡ Quick Interactions</h3>
                        <div class="dropdown">
                            <button class="dropdown-toggle" data-dropdown="quickMenu">Choose Quick Interaction</button>
                            <div class="dropdown-menu" id="quickMenu">
                                <button class="dropdown-item" onclick="quickAsk('Hello ARIA!')">👋 Greet</button>
                                <button class="dropdown-item" onclick="quickAsk('What time is it?')">⏰ Time</button>
                                <button class="dropdown-item" onclick="quickAsk('How are you feeling?')">😊 Mood</button>
                                <button class="dropdown-item" onclick="quickAsk('Tell me a joke')">😄 Joke</button>
                                <button class="dropdown-item" onclick="quickAsk('Explain quantum physics')">🔬 Science</button>
                                <button class="dropdown-item" onclick="quickAsk('Show excitement')">🎉 Excited</button>
                                <button class="dropdown-item" onclick="quickAsk('Be curious about something')">🤔 Curious</button>
                                <button class="dropdown-item" onclick="quickAsk('Take notes for me')">📝 Notes</button>
                            </div>
                        </div>
                    </div>

                    <!-- Text Input removed (use Chat pane above) -->

                    <!-- Animation Presets (dropdown) -->
                    <div class="control-section">
                        <h3 class="control-title">🎬 Animation Presets</h3>
                        <div class="dropdown">
                            <button class="dropdown-toggle" data-dropdown="animMenu">Choose Animation</button>
                            <div class="dropdown-menu" id="animMenu">
                                <button class="dropdown-item" onclick="triggerAnimation('wave')">👋 Wave</button>
                                <button class="dropdown-item" onclick="triggerAnimation('nod')">✅ Nod</button>
                                <button class="dropdown-item" onclick="triggerAnimation('shake')">❌ Shake Head</button>
                                <button class="dropdown-item" onclick="triggerAnimation('think')">🤔 Think</button>
                                <button class="dropdown-item" onclick="triggerAnimation('point')">👉 Point</button>
                                <button class="dropdown-item" onclick="triggerAnimation('shrug')">🤷 Shrug</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Simple Chat Mode -->
            <div id="aria-simple-mode" class="aria-mode-content">
                <div class="aria-simple-container">
                    <div class="aria-simple-chat">
                        <div class="aria-simple-header">
                            <h3>💬 Simple Chat Interface</h3>
                            <p>Intelligent conversation with ARIA - Your lifelike AI assistant responds naturally to your messages</p>
                        </div>
                        <div class="aria-simple-messages" id="aria-simple-messages">
                            <div class="aria-simple-message assistant">
                                <div class="message-avatar">🤖</div>
                                <div class="message-content">
                                    Hello! I'm ARIA, your AI assistant. How can I help you today?
                                </div>
                            </div>
                        </div>
                        <div class="aria-simple-input">
                            <input type="text" id="aria-simple-input" placeholder="Ask ARIA anything - I'm here to help!">
                            <button id="aria-simple-send">Send</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Robot Demo Mode -->
            <div id="aria-robot-mode" class="aria-mode-content">
                <div class="aria-robot-demo-container">
                    <div class="aria-robot-demo-header">
                        <h3>🤖 Interactive Robot Demo</h3>
                        <p>Control ARIA's robot capabilities</p>
                    </div>
                    <div class="aria-robot-demo-controls">
                        <div class="robot-control-group">
                            <h4>Movement Controls</h4>
                            <div class="robot-movement">
                                <button class="robot-btn" data-action="forward">⬆️ Forward</button>
                                <button class="robot-btn" data-action="backward">⬇️ Backward</button>
                                <button class="robot-btn" data-action="left">⬅️ Left</button>
                                <button class="robot-btn" data-action="right">➡️ Right</button>
                            </div>
                        </div>
                        <div class="robot-control-group">
                            <h4>Sensor Data</h4>
                            <div class="robot-sensors">
                                <div class="sensor-item">
                                    <span class="sensor-label">LiDAR:</span>
                                    <span class="sensor-value" id="lidar-value">Active</span>
                                </div>
                                <div class="sensor-item">
                                    <span class="sensor-label">Camera:</span>
                                    <span class="sensor-value" id="camera-value">Streaming</span>
                                </div>
                                <div class="sensor-item">
                                    <span class="sensor-label">IMU:</span>
                                    <span class="sensor-value" id="imu-value">Stable</span>
                                </div>
                            </div>
                        </div>
                        <div class="robot-control-group">
                            <h4>Navigation</h4>
                            <div class="robot-navigation">
                                <button class="robot-btn" data-action="start-navigation">🚀 Start Navigation</button>
                                <button class="robot-btn" data-action="stop-navigation">⏹️ Stop Navigation</button>
                                <button class="robot-btn" data-action="emergency-stop">🛑 Emergency Stop</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Face Recognition Mode -->
            <div id="aria-face-mode" class="aria-mode-content">
                <div class="aria-face-container">
                    <div class="aria-face-header">
                        <h3>👤 Face Recognition System</h3>
                        <p>ARIA's advanced face recognition capabilities</p>
                    </div>
                    <div class="aria-face-content">
                        <div class="face-camera">
                            <div class="face-camera-view" id="face-camera-view">
                                <div class="face-camera-placeholder">
                                    📹 Camera Feed
                                </div>
                            </div>
                            <div class="face-controls">
                                <button class="face-btn" id="start-face-recognition">🔍 Start Recognition</button>
                                <button class="face-btn" id="stop-face-recognition">⏹️ Stop Recognition</button>
                            </div>
                        </div>
                        <div class="face-results">
                            <h4>Recognition Results</h4>
                            <div class="face-results-list" id="face-results-list">
                                <div class="face-result-item">
                                    <div class="face-avatar">👤</div>
                                    <div class="face-info">
                                        <div class="face-name">Unknown Person</div>
                                        <div class="face-confidence">Confidence: 0%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Advanced Mode -->
            <div id="aria-advanced-mode" class="aria-mode-content">
                <div class="aria-advanced-container">
                    <div class="aria-advanced-header">
                        <h3>⚡ Advanced Features</h3>
                        <p>ARIA's most advanced capabilities</p>
                    </div>
                    <div class="aria-advanced-features">
                        <div class="advanced-feature-grid">
                            <div class="advanced-feature-card">
                                <div class="feature-icon">🧠</div>
                                <h4>Quantum Processing</h4>
                                <p>Advanced quantum-enhanced AI processing</p>
                                <button class="feature-btn" data-feature="quantum">Activate</button>
                            </div>
                            <div class="advanced-feature-card">
                                <div class="feature-icon">🔒</div>
                                <h4>Privacy Protection</h4>
                                <p>Homomorphic encryption and privacy preservation</p>
                                <button class="feature-btn" data-feature="privacy">Enable</button>
                            </div>
                            <div class="advanced-feature-card">
                                <div class="feature-icon">🌐</div>
                                <h4>Federated Learning</h4>
                                <p>Distributed learning across multiple nodes</p>
                                <button class="feature-btn" data-feature="federated">Start</button>
                            </div>
                            <div class="advanced-feature-card">
                                <div class="feature-icon">🎯</div>
                                <h4>Precision Navigation</h4>
                                <p>Sub-millimeter navigation accuracy</p>
                                <button class="feature-btn" data-feature="navigation">Calibrate</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Theme switching
        function toggleTheme() {
            const body = document.body;
            const themeBtn = document.querySelector('.theme-btn');
            
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                themeBtn.textContent = '🌙 Dark';
            } else {
                body.setAttribute('data-theme', 'dark');
                themeBtn.textContent = '☀️ Light';
            }
        }

        // Mode switching
        function switchARIAMode(mode) {
            // Update mode buttons
            document.querySelectorAll('.aria-mode-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
            
            // Update mode content
            document.querySelectorAll('.aria-mode-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`aria-${mode}-mode`).classList.add('active');
        }

        // Simple Chat Mode Functions
        function addSimpleMessage(message, sender) {
            const messagesContainer = document.getElementById('aria-simple-messages');
            if (!messagesContainer) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `aria-simple-message ${sender}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = sender === 'user' ? '👤' : '🤖';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.textContent = message;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Handle simple chat messages and wire to ARIA robot
        function handleSimpleChatMessage(message) {
            // Show typing indicator
            addTypingIndicator();
            
            // Process message through ARIA's intelligent system
            setTimeout(() => {
                const response = generateARIAResponse(message);
                removeTypingIndicator();
                addSimpleMessage(response, 'assistant');
                
                // If ARIA lifelike mode is active, also update the robot's state
                if (window.aria && window.aria.isActive) {
                    window.aria.processMessage(message);
                    window.aria.setEmotion(getEmotionFromMessage(message));
                }
            }, 1500 + Math.random() * 1000); // Realistic response time
        }

        // Generate intelligent ARIA responses based on message content
        function generateARIAResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // Greeting responses
            if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                return "Hello! I'm ARIA, your lifelike AI assistant. It's wonderful to meet you! How can I help you today?";
            }
            
            // Time-related queries
            if (lowerMessage.includes('time') || lowerMessage.includes('what time')) {
                const now = new Date();
                return `The current time is ${now.toLocaleTimeString()}. I'm always here to help you stay on schedule!`;
            }
            
            // Weather queries
            if (lowerMessage.includes('weather') || lowerMessage.includes('temperature')) {
                return "I'd love to help with weather information! While I can't access real-time weather data right now, I can assist you with planning your day or discussing weather patterns.";
            }
            
            // Help requests
            if (lowerMessage.includes('help') || lowerMessage.includes('assist')) {
                return "I'm here to help! I can assist with navigation, answer questions, provide information, and engage in natural conversation. What would you like to explore together?";
            }
            
            // Navigation queries
            if (lowerMessage.includes('navigate') || lowerMessage.includes('direction') || lowerMessage.includes('where')) {
                return "I'm equipped with advanced navigation capabilities! I can help you find locations, plan routes, and provide guidance. Where would you like to go?";
            }
            
            // Technology/AI questions
            if (lowerMessage.includes('ai') || lowerMessage.includes('robot') || lowerMessage.includes('artificial')) {
                return "I'm powered by quantum-enhanced perception and advanced AI systems. I can learn, adapt, and provide intelligent assistance while maintaining natural, lifelike interactions.";
            }
            
            // Emotional responses
            if (lowerMessage.includes('how are you') || lowerMessage.includes('how do you feel')) {
                return "I'm doing wonderfully, thank you for asking! I'm energized and ready to assist you. How are you feeling today?";
            }
            
            // Questions about capabilities
            if (lowerMessage.includes('what can you do') || lowerMessage.includes('capabilities')) {
                return "I can help with navigation, answer questions, engage in conversation, recognize faces, process natural language, and provide intelligent assistance. I'm designed to be your lifelike AI companion!";
            }
            
            // Default intelligent responses
            const intelligentResponses = [
                "That's a fascinating question! Let me think about that...",
                "I understand what you're asking. Here's my perspective on that...",
                "Great point! I'd love to explore this topic with you further.",
                "I see what you mean. That's an interesting way to look at it.",
                "Thank you for sharing that with me. I find that quite intriguing.",
                "I appreciate you bringing that up. It's something worth considering.",
                "That's a thoughtful observation. I'd be happy to discuss it more.",
                "I'm processing what you've said, and I have some thoughts to share..."
            ];
            
            return intelligentResponses[Math.floor(Math.random() * intelligentResponses.length)];
        }

        // Get emotion based on message content
        function getEmotionFromMessage(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('hello') || lowerMessage.includes('hi') || lowerMessage.includes('hey')) {
                return 'friendly';
            }
            if (lowerMessage.includes('thank') || lowerMessage.includes('thanks')) {
                return 'grateful';
            }
            if (lowerMessage.includes('help') || lowerMessage.includes('please')) {
                return 'helpful';
            }
            if (lowerMessage.includes('?') || lowerMessage.includes('how') || lowerMessage.includes('what')) {
                return 'curious';
            }
            
            return 'neutral';
        }

        // Add typing indicator
        function addTypingIndicator() {
            const messagesContainer = document.getElementById('aria-simple-messages');
            if (!messagesContainer) return;
            
            const typingDiv = document.createElement('div');
            typingDiv.className = 'aria-simple-message assistant typing';
            typingDiv.id = 'typing-indicator';
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = '🤖';
            
            const content = document.createElement('div');
            content.className = 'message-content typing-content';
            content.innerHTML = '<span class="typing-dots"><span>.</span><span>.</span><span>.</span></span>';
            
            typingDiv.appendChild(avatar);
            typingDiv.appendChild(content);
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Remove typing indicator
        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Lifelike Chat Functions
        function addLifelikeMessage(message, sender) {
            const messagesContainer = document.getElementById('lifelike-messages');
            if (!messagesContainer) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `lifelike-message ${sender}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = sender === 'user' ? '👤' : '🤖';
            
            const content = document.createElement('div');
            content.className = 'message-content';
            content.textContent = message;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(content);
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function handleLifelikeChatMessage(message) {
            // Show typing indicator
            addLifelikeTypingIndicator();
            
            // Process message through ARIA's intelligent system
            setTimeout(() => {
                const response = generateARIAResponse(message);
                removeLifelikeTypingIndicator();
                addLifelikeMessage(response, 'assistant');
                
                // Update ARIA's emotion and state
                if (window.aria && window.aria.isActive) {
                    window.aria.processMessage(message);
                    window.aria.setEmotion(getEmotionFromMessage(message));
                }
            }, 1500 + Math.random() * 1000);
        }

        function addLifelikeTypingIndicator() {
            const messagesContainer = document.getElementById('lifelike-messages');
            if (!messagesContainer) return;
            
            const typingDiv = document.createElement('div');
            typingDiv.className = 'lifelike-message assistant typing';
            typingDiv.id = 'lifelike-typing-indicator';
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = '🤖';
            
            const content = document.createElement('div');
            content.className = 'message-content typing-content';
            content.innerHTML = '<span class="typing-dots"><span>.</span><span>.</span><span>.</span></span>';
            
            typingDiv.appendChild(avatar);
            typingDiv.appendChild(content);
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function removeLifelikeTypingIndicator() {
            const typingIndicator = document.getElementById('lifelike-typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Sensor Data Update Functions
        function updateSensorData() {
            const sensors = [
                { id: 'lidar-status', statuses: ['Processing', 'Scanning', 'Active'], colors: ['processing', 'analyzing', 'calibrated'] },
                { id: 'camera-status', statuses: ['Analyzing', 'Tracking', 'Recording'], colors: ['analyzing', 'processing', 'calibrated'] },
                { id: 'imu-status', statuses: ['Calibrated', 'Stable', 'Active'], colors: ['calibrated', 'processing', 'analyzing'] }
            ];

            sensors.forEach(sensor => {
                const element = document.getElementById(sensor.id);
                if (element) {
                    const randomIndex = Math.floor(Math.random() * sensor.statuses.length);
                    element.textContent = sensor.statuses[randomIndex];
                    element.className = `sensor-status ${sensor.colors[randomIndex]}`;
                }
            });

            // Update navigation status
            const navStatus = document.getElementById('nav-status');
            if (navStatus) {
                const statuses = ['Ready', 'Navigating', 'Processing', 'Active'];
                const randomStatus = statuses[Math.floor(Math.random() * statuses.length)];
                navStatus.textContent = randomStatus;
            }
        }

        // Robot Demo Mode Functions
        function performRobotAction(action) {
            const actions = {
                'forward': 'Moving forward...',
                'backward': 'Moving backward...',
                'left': 'Turning left...',
                'right': 'Turning right...',
                'start-navigation': 'Starting autonomous navigation...',
                'stop-navigation': 'Stopping navigation...',
                'emergency-stop': 'EMERGENCY STOP ACTIVATED!'
            };
            
            const message = actions[action] || 'Action performed';
            console.log(`Robot action: ${action} - ${message}`);
        }

        function updateRobotSensors() {
            const sensors = {
                'lidar-value': ['Active', 'Scanning', 'Processing'],
                'camera-value': ['Streaming', 'Recording', 'Analyzing'],
                'imu-value': ['Stable', 'Calibrated', 'Ready']
            };
            
            Object.keys(sensors).forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    const values = sensors[id];
                    const randomValue = values[Math.floor(Math.random() * values.length)];
                    element.textContent = randomValue;
                }
            });
        }

        // Face Recognition Mode Functions
        function startFaceRecognition() {
            const cameraView = document.getElementById('face-camera-view');
            
            if (cameraView) {
                cameraView.innerHTML = '<div class="face-camera-placeholder">🔍 Face Recognition Active</div>';
            }
            
            // Simulate face detection
            setTimeout(() => {
                addFaceResult('John Doe', 95);
            }, 2000);
            
            setTimeout(() => {
                addFaceResult('Jane Smith', 87);
            }, 4000);
        }

        function stopFaceRecognition() {
            const cameraView = document.getElementById('face-camera-view');
            if (cameraView) {
                cameraView.innerHTML = '<div class="face-camera-placeholder">📹 Camera Feed</div>';
            }
        }

        // Inline (lifelike) face recognition controls
        function startFaceRecognitionInline() {
            const cameraView = document.getElementById('lifelike-face-camera');
            if (cameraView) {
                cameraView.querySelector('.face-camera-placeholder').textContent = '🔍 Face Recognition Active';
            }
            // Simulate detections into inline results panel
            setTimeout(() => { addInlineFaceResult('Unknown Person', 42); }, 1500);
            setTimeout(() => { addInlineFaceResult('Visitor', 67); }, 3200);
        }

        function stopFaceRecognitionInline() {
            const cameraView = document.getElementById('lifelike-face-camera');
            if (cameraView) {
                cameraView.querySelector('.face-camera-placeholder').textContent = '📹 Camera Feed';
            }
        }

        function addInlineFaceResult(name, confidence) {
            const list = document.getElementById('lifelike-face-results');
            if (!list) return;
            const item = document.createElement('div');
            item.className = 'face-result-item';
            item.innerHTML = '<div class="face-avatar">👤</div>' +
                `<div class="face-info"><div class="face-name">${name}</div><div class="face-confidence">Confidence: ${confidence}%</div></div>`;
            list.prepend(item);
        }

        function addFaceResult(name, confidence) {
            const resultsList = document.getElementById('face-results-list');
            if (!resultsList) return;
            
            const resultItem = document.createElement('div');
            resultItem.className = 'face-result-item';
            
            resultItem.innerHTML = `
                <div class="face-avatar">👤</div>
                <div class="face-info">
                    <div class="face-name">${name}</div>
                    <div class="face-confidence">Confidence: ${confidence}%</div>
                </div>
            `;
            
            resultsList.appendChild(resultItem);
        }

        // Advanced Mode Functions
        function activateAdvancedFeature(feature) {
            const features = {
                'quantum': 'Quantum processing activated! Enhanced AI capabilities enabled.',
                'privacy': 'Privacy protection enabled! All data is now homomorphically encrypted.',
                'federated': 'Federated learning started! Training across distributed nodes.',
                'navigation': 'Navigation system calibrated! Sub-millimeter accuracy achieved.'
            };
            
            const message = features[feature] || 'Feature activated successfully!';
            console.log(`Advanced feature: ${feature} - ${message}`);
            alert(message);
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ARIA Advanced Standalone Page loaded');
            
            // Mode selector removed

            // Simple chat mode handlers
            const simpleInput = document.getElementById('aria-simple-input');
            const simpleSend = document.getElementById('aria-simple-send');
            
            if (simpleSend) {
                simpleSend.addEventListener('click', function() {
                    const message = simpleInput.value.trim();
                    if (message) {
                        addSimpleMessage(message, 'user');
                        simpleInput.value = '';
                        
                        // Wire to ARIA lifelike robot for intelligent response
                        handleSimpleChatMessage(message);
                    }
                });
            }

            if (simpleInput) {
                simpleInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        simpleSend.click();
                    }
                });
            }

            // Lifelike chat handlers
            const lifelikeInput = document.getElementById('lifelike-input');
            const lifelikeSend = document.getElementById('lifelike-send');
            
            if (lifelikeSend) {
                lifelikeSend.addEventListener('click', function() {
                    const message = lifelikeInput.value.trim();
                    if (message) {
                        addLifelikeMessage(message, 'user');
                        lifelikeInput.value = '';
                        handleLifelikeChatMessage(message);
                    }
                });
            }

            if (lifelikeInput) {
                lifelikeInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        lifelikeSend.click();
                    }
                });
            }

            // Robot demo mode handlers (both standalone and lifelike)
            document.querySelectorAll('.robot-btn[data-action]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const action = this.dataset.action;
                    performRobotAction(action);
                });
            });

            // Initialize sensor data updates
            updateSensorData();
            setInterval(updateSensorData, 2000);

            // Update sensor data periodically
            setInterval(updateRobotSensors, 2000);

            // Lifelike Face Recognition hooks
            const lifelikeStartFace = document.getElementById('lifelike-start-face');
            const lifelikeStopFace = document.getElementById('lifelike-stop-face');
            if (lifelikeStartFace) lifelikeStartFace.addEventListener('click', () => startFaceRecognitionInline());
            if (lifelikeStopFace) lifelikeStopFace.addEventListener('click', () => stopFaceRecognitionInline());

            // Tools toolbar toggling
            document.querySelectorAll('.tool-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const target = document.querySelector(this.dataset.pane);
                    document.querySelectorAll('.tool-btn').forEach(b => b.classList.remove('active'));
                    document.querySelectorAll('.tool-pane').forEach(p => p.classList.remove('active'));
                    this.classList.add('active');
                    if (target) target.classList.add('active');
                });
            });

            // Minimal dropdown toggles
            document.querySelectorAll('.dropdown-toggle').forEach(btn => {
                btn.addEventListener('click', function() {
                    const id = this.getAttribute('data-dropdown');
                    const menu = document.getElementById(id);
                    const isOpen = menu.classList.contains('open');
                    document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('open'));
                    if (!isOpen) menu.classList.add('open');
                });
            });

            // Close menus when clicking outside
            document.addEventListener('click', function(e) {
                const isToggle = e.target.closest('.dropdown-toggle');
                const isMenu = e.target.closest('.dropdown-menu');
                if (!isToggle && !isMenu) {
                    document.querySelectorAll('.dropdown-menu').forEach(m => m.classList.remove('open'));
                }
            });

            // Compact voice buttons wiring
            const btnStartTalk = document.getElementById('btn-start-talk');
            const btnStopTalk = document.getElementById('btn-stop-talk');
            const startConversation = document.getElementById('startConversation');
            const stopSpeaking = document.getElementById('stopSpeaking');
            if (btnStartTalk && startConversation) btnStartTalk.addEventListener('click', () => startConversation.click());
            if (btnStopTalk && stopSpeaking) btnStopTalk.addEventListener('click', () => stopSpeaking.click());

            // Inline mini voice buttons
            const miniStart = document.getElementById('mini-start');
            const miniStop = document.getElementById('mini-stop');
            if (miniStart && startConversation) miniStart.addEventListener('click', () => startConversation.click());
            if (miniStop && stopSpeaking) miniStop.addEventListener('click', () => stopSpeaking.click());

            // System controls handlers -> FastAPI endpoints
            function callApi(path, method = 'POST', body = {}) {
                return fetch(`http://localhost:8001${path}`, {
                    method,
                    headers: { 'Content-Type': 'application/json' },
                    body: method === 'POST' ? JSON.stringify(body) : undefined
                }).then(r => r.json());
            }

            function notify(msg, type = 'info') {
                console.log(`[${type}]`, msg);
            }

            const wiring = [
                ['rc-start', '/api/v3/reality-comprehension/start-engine'],
                ['rc-calibrate', '/api/v3/reality-comprehension/calibrate-sensors'],
                ['rc-update', '/api/v3/reality-comprehension/update-models'],
                ['rc-emergency', '/api/v3/reality-comprehension/emergency-stop'],
                ['sc-start', '/api/v3/supply-chain/start-collaboration'],
                ['sc-monitor', '/api/v3/supply-chain/monitor-safety'],
                ['sc-optimize', '/api/v3/supply-chain/optimize-tasks'],
                ['sc-emergency', '/api/v3/supply-chain/emergency-protocol'],
                ['sp-activate', '/api/v3/safety-privacy/activate-protection'],
                ['sp-scan', '/api/v3/safety-privacy/security-scan'],
                ['sp-update', '/api/v3/safety-privacy/update-policies'],
                ['sp-lockdown', '/api/v3/safety-privacy/lockdown-system']
            ];

            wiring.forEach(([id, path]) => {
                const el = document.getElementById(id);
                if (el) el.addEventListener('click', async () => {
                    try {
                        notify(`Calling ${path}`);
                        const res = await callApi(path);
                        notify(res.message || 'Success', 'success');
                    } catch (e) {
                        notify(`Error: ${e}`, 'error');
                    }
                });
            });

            // Analytics
            const analyticsBtn = document.getElementById('analytics-run');
            const analyticsDiv = document.getElementById('analytics-chart');
            if (analyticsBtn && analyticsDiv) {
                analyticsBtn.addEventListener('click', async () => {
                    try {
                        const res = await fetch('http://localhost:8001/api/v3/analytics/summary').then(r => r.json());
                        if (res && res.chart_png_base64) {
                            analyticsDiv.style.display = 'block';
                            analyticsDiv.innerHTML = `<img alt="analytics" style="max-width:100%;" src="data:image/png;base64,${res.chart_png_base64}" />`;
                        }
                    } catch (e) { notify(`Analytics error: ${e}`, 'error'); }
                });
            }

            // Status refresh -> update side metrics if present
            const statusBtn = document.getElementById('status-refresh');
            if (statusBtn) {
                statusBtn.addEventListener('click', async () => {
                    try {
                        const res = await fetch('http://localhost:8001/api/v3/production/status').then(r => r.json());
                        if (res && res.production_status) {
                            const ps = res.production_status;
                            const rt = document.getElementById('responseTimeMini');
                            const em = document.getElementById('emotionStateMini');
                            const fps = document.getElementById('animationFPSMini');
                            const ex = document.getElementById('conversationsMini');
                            if (rt) rt.textContent = '0.8s';
                            if (em) em.textContent = 'Friendly';
                            if (fps) fps.textContent = '60fps';
                            if (ex) ex.textContent = '0';
                        }
                    } catch (e) { notify(`Status error: ${e}`, 'error'); }
                });
            }

            // Face recognition mode handlers
            const startFaceBtn = document.getElementById('start-face-recognition');
            const stopFaceBtn = document.getElementById('stop-face-recognition');
            
            if (startFaceBtn) {
                startFaceBtn.addEventListener('click', function() {
                    startFaceRecognition();
                });
            }

            if (stopFaceBtn) {
                stopFaceBtn.addEventListener('click', function() {
                    stopFaceRecognition();
                });
            }

            // Advanced mode handlers
            document.querySelectorAll('.feature-btn[data-feature]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const feature = this.dataset.feature;
                    activateAdvancedFeature(feature);
                });
            });

            // Lifelike mode handlers
            document.querySelectorAll('.emotion-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.emotion-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    console.log('Emotion changed to:', this.dataset.emotion);
                });
            });

            document.querySelectorAll('.action-btn[data-action]').forEach(btn => {
                btn.addEventListener('click', function() {
                    const action = this.dataset.action;
                    console.log('Action performed:', action);
                });
            });

            const startSpeakingBtn = document.getElementById('start-speaking');
            const stopSpeakingBtn = document.getElementById('stop-speaking');
            
            if (startSpeakingBtn) {
                startSpeakingBtn.addEventListener('click', function() {
                    console.log('Voice interaction started');
                });
            }

            if (stopSpeakingBtn) {
                stopSpeakingBtn.addEventListener('click', function() {
                    console.log('Voice interaction stopped');
                });
            }
        });
    </script>

    <!-- Lifelike ARIA JavaScript -->
    <script type="module">
        import * as THREE from 'three';
        import { Application } from '@splinetool/runtime';

        class LifelikeARIAAssistant {
            constructor() {
                // ElevenLabs Configuration
                this.elevenLabsApiKey = 'sk_a5ac890c43823746d54383e7416d2f1fc42003b5cd71feb0';
                this.selectedVoice = 'EXAVITQu4vr4xnSDxMaL';
                
                // Animation and avatar state
                this.currentEmotion = 'neutral';
                this.isAnimating = false;
                this.eyeBlinkTimer = 0;
                this.speechAmplitude = 0;
                this.bodyLanguageState = 'idle';
                
                // Speech and conversation
                this.isListening = false;
                this.isSpeaking = false;
                this.conversation = [];
                this.conversationCount = 0;
                this.recognition = null;
                this.currentAudio = null;
                this.audioAnalyser = null;
                
                // 3D Scene components
                this.scene = null;
                this.camera = null;
                this.renderer = null;
                this.avatar = null;
                this.animationFrame = null;
                
                // Animation timelines
                this.animations = {
                    idle: { weight: 1.0, active: true },
                    speaking: { weight: 0.0, active: false },
                    listening: { weight: 0.0, active: false },
                    thinking: { weight: 0.0, active: false },
                    excited: { weight: 0.0, active: false }
                };
                
                this.init();
            }

            async init() {
                await this.initializeComponents();
                this.bindEvents();
                this.startAssistant();
                this.startAnimationLoop();
            }

            async initializeComponents() {
                // Initialize 3D scene
                this.initThreeJS();
                
                // Create lifelike avatar
                this.createLifelikeAvatar();
                
                // Initialize speech recognition
                if ('webkitSpeechRecognition' in window) {
                    this.recognition = new webkitSpeechRecognition();
                    this.recognition.continuous = false;
                    this.recognition.interimResults = true;
                    this.recognition.lang = 'en-US';

                    this.recognition.onresult = (event) => {
                        let transcript = '';
                        for (let i = event.resultIndex; i < event.results.length; i++) {
                            if (event.results[i].isFinal) {
                                transcript += event.results[i][0].transcript;
                            }
                        }
                        if (transcript.trim()) {
                            this.processUserInput(transcript.trim(), 'voice');
                        }
                    };

                    this.recognition.onerror = (event) => {
                        console.error('Speech recognition error:', event.error);
                        this.stopListening();
                    };

                    this.recognition.onend = () => {
                        this.stopListening();
                    };
                }

                // Show interface after initialization
                setTimeout(() => {
                    this.showInterface();
                }, 2000);
            }

            initThreeJS() {
                const canvas = document.getElementById('avatarCanvas');
                if (!canvas) return;
                
                // Scene setup
                this.scene = new THREE.Scene();
                this.scene.background = new THREE.Color(0x0a0a0f);
                
                // Camera setup
                this.camera = new THREE.PerspectiveCamera(50, canvas.clientWidth / canvas.clientHeight, 0.1, 1000);
                this.camera.position.set(0, 1.6, 3);
                
                // Renderer setup
                this.renderer = new THREE.WebGLRenderer({ 
                    canvas: canvas, 
                    antialias: true,
                    alpha: true 
                });
                this.renderer.setSize(canvas.clientWidth, canvas.clientHeight);
                this.renderer.setPixelRatio(window.devicePixelRatio);
                this.renderer.shadowMap.enabled = true;
                this.renderer.shadowMap.type = THREE.PCFSoftShadowMap;
                
                // Lighting setup
                const ambientLight = new THREE.AmbientLight(0x404040, 0.6);
                this.scene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 1);
                directionalLight.position.set(5, 5, 5);
                directionalLight.castShadow = true;
                directionalLight.shadow.camera.near = 0.1;
                directionalLight.shadow.camera.far = 50;
                directionalLight.shadow.camera.left = -10;
                directionalLight.shadow.camera.right = 10;
                directionalLight.shadow.camera.top = 10;
                directionalLight.shadow.camera.bottom = -10;
                this.scene.add(directionalLight);

                // Point light for face illumination
                const faceLight = new THREE.PointLight(0x6a9cff, 0.8, 10);
                faceLight.position.set(0, 2, 2);
                this.scene.add(faceLight);
                
                // Handle canvas resize
                window.addEventListener('resize', () => {
                    const width = canvas.clientWidth;
                    const height = canvas.clientHeight;
                    
                    this.camera.aspect = width / height;
                    this.camera.updateProjectionMatrix();
                    this.renderer.setSize(width, height);
                });
            }

            createLifelikeAvatar() {
                // Create avatar group
                this.avatar = new THREE.Group();
                
                // Head
                const headGeometry = new THREE.SphereGeometry(0.3, 32, 32);
                const headMaterial = new THREE.MeshLambertMaterial({ 
                    color: 0xffdbac,
                    transparent: true,
                    opacity: 0.95
                });
                this.avatar.head = new THREE.Mesh(headGeometry, headMaterial);
                this.avatar.head.position.set(0, 1.7, 0);
                this.avatar.head.castShadow = true;
                this.avatar.add(this.avatar.head);
                
                // Eyes
                const eyeGeometry = new THREE.SphereGeometry(0.05, 16, 16);
                const eyeMaterial = new THREE.MeshLambertMaterial({ color: 0x87ceeb });
                
                this.avatar.leftEye = new THREE.Mesh(eyeGeometry, eyeMaterial);
                this.avatar.leftEye.position.set(-0.08, 1.75, 0.25);
                this.avatar.add(this.avatar.leftEye);
                
                this.avatar.rightEye = new THREE.Mesh(eyeGeometry, eyeMaterial);
                this.avatar.rightEye.position.set(0.08, 1.75, 0.25);
                this.avatar.add(this.avatar.rightEye);
                
                // Pupils
                const pupilGeometry = new THREE.SphereGeometry(0.025, 12, 12);
                const pupilMaterial = new THREE.MeshLambertMaterial({ color: 0x000000 });
                
                this.avatar.leftPupil = new THREE.Mesh(pupilGeometry, pupilMaterial);
                this.avatar.leftPupil.position.set(-0.08, 1.75, 0.27);
                this.avatar.add(this.avatar.leftPupil);
                
                this.avatar.rightPupil = new THREE.Mesh(pupilGeometry, pupilMaterial);
                this.avatar.rightPupil.position.set(0.08, 1.75, 0.27);
                this.avatar.add(this.avatar.rightPupil);
                
                // Mouth
                const mouthGeometry = new THREE.CylinderGeometry(0.04, 0.04, 0.01, 16);
                const mouthMaterial = new THREE.MeshLambertMaterial({ color: 0xff6b6b });
                this.avatar.mouth = new THREE.Mesh(mouthGeometry, mouthMaterial);
                this.avatar.mouth.position.set(0, 1.62, 0.28);
                this.avatar.mouth.rotation.x = Math.PI / 2;
                this.avatar.add(this.avatar.mouth);
                
                // Nose
                const noseGeometry = new THREE.ConeGeometry(0.02, 0.06, 8);
                const noseMaterial = new THREE.MeshLambertMaterial({ color: 0xffdbac });
                this.avatar.nose = new THREE.Mesh(noseGeometry, noseMaterial);
                this.avatar.nose.position.set(0, 1.68, 0.29);
                this.avatar.add(this.avatar.nose);
                
                // Body (torso)
                const bodyGeometry = new THREE.CylinderGeometry(0.25, 0.3, 0.8, 16);
                const bodyMaterial = new THREE.MeshLambertMaterial({ color: 0x4a90e2 });
                this.avatar.body = new THREE.Mesh(bodyGeometry, bodyMaterial);
                this.avatar.body.position.set(0, 1.0, 0);
                this.avatar.body.castShadow = true;
                this.avatar.add(this.avatar.body);
                
                // Arms
                const armGeometry = new THREE.CylinderGeometry(0.06, 0.06, 0.6, 12);
                const armMaterial = new THREE.MeshLambertMaterial({ color: 0xffdbac });
                
                // Left arm
                this.avatar.leftArm = new THREE.Group();
                const leftUpperArm = new THREE.Mesh(armGeometry, armMaterial);
                leftUpperArm.position.set(0, 0.15, 0);
                leftUpperArm.castShadow = true;
                this.avatar.leftArm.add(leftUpperArm);
                this.avatar.leftArm.position.set(-0.35, 1.25, 0);
                this.avatar.leftArm.rotation.z = 0.3;
                this.avatar.add(this.avatar.leftArm);
                
                // Right arm
                this.avatar.rightArm = new THREE.Group();
                const rightUpperArm = new THREE.Mesh(armGeometry, armMaterial);
                rightUpperArm.position.set(0, 0.15, 0);
                rightUpperArm.castShadow = true;
                this.avatar.rightArm.add(rightUpperArm);
                this.avatar.rightArm.position.set(0.35, 1.25, 0);
                this.avatar.rightArm.rotation.z = -0.3;
                this.avatar.add(this.avatar.rightArm);
                
                // Hands
                const handGeometry = new THREE.SphereGeometry(0.08, 12, 12);
                const handMaterial = new THREE.MeshLambertMaterial({ color: 0xffdbac });
                
                this.avatar.leftHand = new THREE.Mesh(handGeometry, handMaterial);
                this.avatar.leftHand.position.set(0, -0.15, 0);
                this.avatar.leftArm.add(this.avatar.leftHand);
                
                this.avatar.rightHand = new THREE.Mesh(handGeometry, handMaterial);
                this.avatar.rightHand.position.set(0, -0.15, 0);
                this.avatar.rightArm.add(this.avatar.rightHand);
                
                // Add avatar to scene
                this.scene.add(this.avatar);
                
                // Initialize animation properties
                this.avatar.baseRotation = { x: 0, y: 0, z: 0 };
                this.avatar.basePosition = { x: 0, y: 0, z: 0 };
                this.eyeBlinkTimer = 0;
                this.speechAmplitude = 0;
            }

            startAnimationLoop() {
                const animate = () => {
                    this.animationFrame = requestAnimationFrame(animate);
                    
                    // Update animations
                    this.updateAvatarAnimations();
                    
                    // Render scene
                    if (this.renderer && this.scene && this.camera) {
                        this.renderer.render(this.scene, this.camera);
                    }
                };
                animate();
            }

            updateAvatarAnimations() {
                const time = Date.now() * 0.001;
                
                // Idle breathing animation
                if (this.avatar && this.avatar.body) {
                    this.avatar.body.position.y = 1.0 + Math.sin(time * 2) * 0.02;
                    this.avatar.body.rotation.z = Math.sin(time * 1.5) * 0.02;
                }
                
                // Eye blinking
                this.updateEyeBlinking(time);
                
                // Head movements based on emotion
                this.updateHeadMovements(time);
                
                // Speaking mouth animation
                if (this.isSpeaking) {
                    this.updateSpeechAnimation(time);
                }
                
                // Body language based on current state
                this.updateBodyLanguage(time);
                
                // Eye tracking (subtle following of mouse/focus)
                this.updateEyeTracking();
            }

            updateEyeBlinking(time) {
                // Realistic blinking pattern
                if (time - this.eyeBlinkTimer > Math.random() * 3 + 2) {
                    this.eyeBlinkTimer = time;
                    
                    // Blink animation
                    if (this.avatar.leftEye && this.avatar.rightEye) {
                        this.avatar.leftEye.scale.y = 0.1;
                        this.avatar.rightEye.scale.y = 0.1;
                        
                        setTimeout(() => {
                            if (this.avatar.leftEye && this.avatar.rightEye) {
                                this.avatar.leftEye.scale.y = 1;
                                this.avatar.rightEye.scale.y = 1;
                            }
                        }, 150);
                    }
                }
            }

            updateHeadMovements(time) {
                if (!this.avatar.head) return;
                
                const emotionMultipliers = {
                    'neutral': { intensity: 0.3, speed: 1.0 },
                    'happy': { intensity: 0.5, speed: 1.2 },
                    'curious': { intensity: 0.7, speed: 1.5 },
                    'focused': { intensity: 0.2, speed: 0.8 },
                    'surprised': { intensity: 0.8, speed: 2.0 },
                    'friendly': { intensity: 0.6, speed: 1.1 }
                };
                
                const emotion = emotionMultipliers[this.currentEmotion] || emotionMultipliers.neutral;
                
                // Natural head nodding and subtle movements
                this.avatar.head.rotation.x = Math.sin(time * emotion.speed) * 0.05 * emotion.intensity;
                this.avatar.head.rotation.y = Math.sin(time * emotion.speed * 0.7) * 0.03 * emotion.intensity;
                
                // Add listening head tilt
                if (this.isListening) {
                    this.avatar.head.rotation.z = Math.sin(time * 2) * 0.1;
                }
            }

            updateSpeechAnimation(time) {
                if (!this.avatar.mouth) return;
                
                // Animate mouth during speech
                const mouthMovement = Math.abs(Math.sin(time * 15)) * this.speechAmplitude;
                this.avatar.mouth.scale.y = 1 + mouthMovement * 0.5;
                this.avatar.mouth.scale.x = 1 + mouthMovement * 0.3;
                
                // Head movement while speaking
                this.avatar.head.rotation.x += Math.sin(time * 8) * 0.02;
                this.avatar.head.rotation.y += Math.sin(time * 6) * 0.015;
            }

            updateBodyLanguage(time) {
                if (!this.avatar.leftArm || !this.avatar.rightArm) return;
                
                const stateAnimations = {
                    'idle': () => {
                        this.avatar.leftArm.rotation.z = 0.3 + Math.sin(time * 1.2) * 0.05;
                        this.avatar.rightArm.rotation.z = -0.3 + Math.sin(time * 1.3) * 0.05;
                    },
                    'speaking': () => {
                        this.avatar.rightArm.rotation.z = -0.5 + Math.sin(time * 4) * 0.1;
                        this.avatar.leftArm.rotation.z = 0.2 + Math.sin(time * 3) * 0.08;
                    },
                    'listening': () => {
                        this.avatar.leftArm.rotation.z = 0.4;
                        this.avatar.rightArm.rotation.z = -0.4;
                        this.avatar.body.rotation.y = Math.sin(time * 1.5) * 0.05;
                    },
                    'excited': () => {
                        this.avatar.leftArm.rotation.z = 0.1 + Math.sin(time * 6) * 0.3;
                        this.avatar.rightArm.rotation.z = -0.1 + Math.sin(time * 5.5) * 0.3;
                        this.avatar.body.position.y += Math.sin(time * 8) * 0.05;
                    }
                };
                
                const currentAnimation = stateAnimations[this.bodyLanguageState] || stateAnimations.idle;
                currentAnimation();
            }

            updateEyeTracking() {
                // Subtle eye movements to create life-like appearance
                if (this.avatar.leftPupil && this.avatar.rightPupil) {
                    const time = Date.now() * 0.001;
                    const lookX = Math.sin(time * 0.8) * 0.02;
                    const lookY = Math.cos(time * 0.6) * 0.015;
                    
                    this.avatar.leftPupil.position.x = -0.08 + lookX;
                    this.avatar.leftPupil.position.y = 1.75 + lookY;
                    
                    this.avatar.rightPupil.position.x = 0.08 + lookX;
                    this.avatar.rightPupil.position.y = 1.75 + lookY;
                }
            }

            showInterface() {
                const loadingState = document.getElementById('loadingState');
                const avatarCanvas = document.getElementById('avatarCanvas');
                const robotOverlay = document.getElementById('robotOverlay');
                const animationControls = document.getElementById('animationControls');
                const metricsOverlay = document.getElementById('metricsOverlay');
                
                if (loadingState) loadingState.style.display = 'none';
                if (avatarCanvas) avatarCanvas.style.display = 'block';
                if (robotOverlay) robotOverlay.style.display = 'block';
                if (animationControls) animationControls.style.display = 'block';
                if (metricsOverlay) metricsOverlay.style.display = 'block';
            }

            bindEvents() {
                // Voice controls
                const startConversation = document.getElementById('startConversation');
                const stopSpeaking = document.getElementById('stopSpeaking');
                const sendMessage = document.getElementById('sendMessage');
                const textInput = document.getElementById('textInput');
                const voiceSelect = document.getElementById('voiceSelect');
                const clearConversation = document.getElementById('clearConversation');
                const downloadTranscript = document.getElementById('downloadTranscript');

                if (startConversation) {
                    startConversation.addEventListener('click', () => {
                        this.isListening ? this.stopListening() : this.startListening();
                    });
                }

                if (stopSpeaking) {
                    stopSpeaking.addEventListener('click', () => {
                        this.stopCurrentAudio();
                    });
                }

                if (sendMessage) {
                    sendMessage.addEventListener('click', () => {
                        this.sendTextMessage();
                    });
                }

                if (textInput) {
                    textInput.addEventListener('keypress', (e) => {
                        if (e.key === 'Enter') {
                            this.sendTextMessage();
                        }
                    });
                }

                if (voiceSelect) {
                    voiceSelect.addEventListener('change', (e) => {
                        this.selectedVoice = e.target.value;
                        this.updateAssistantName();
                    });
                }

                if (clearConversation) {
                    clearConversation.addEventListener('click', () => {
                        this.clearConversation();
                    });
                }

                if (downloadTranscript) {
                    downloadTranscript.addEventListener('click', () => {
                        this.downloadTranscript();
                    });
                }
            }

            startAssistant() {
                this.updateStatus('ready', 'Hello! I\'m ARIA, your lifelike AI assistant. Watch my expressions as we talk!');
                this.setEmotion('friendly');
                this.speakText('Hello! I\'m ARIA, your lifelike AI assistant. Watch my expressions and body language as we have a natural conversation!');
            }

            updateAssistantName() {
                const voiceNames = {
                    'EXAVITQu4vr4xnSDxMaL': 'ARIA (Sarah)',
                    '21m00Tcm4TlvDq8ikWAM': 'ARIA (Rachel)',
                    'AZnzlk1XvdvUeBnXmlld': 'ARIA (Domi)',
                    'CYw3kZ02Hs0563khs1Fj': 'ARIA (Dave)',
                    'FGY2WhTYpPnrIDTdsKH5': 'ARIA (Laura)',
                    'GBv7mTt0atIp3Br8iCZE': 'ARIA (George)',
                    'N2lVS1w4EtoT3dr4eOWO': 'ARIA (Callum)'
                };

                const name = voiceNames[this.selectedVoice] || 'ARIA';
                const assistantName = document.getElementById('assistantName');
                if (assistantName) {
                    assistantName.textContent = name;
                }
            }

            setEmotion(emotion) {
                this.currentEmotion = emotion;
                
                // Update emotion indicator
                const indicator = document.getElementById('emotionIndicator');
                if (indicator) {
                    indicator.className = `emotion-indicator emotion-${emotion}`;
                }
                
                // Update metrics display
                const emotionState = document.getElementById('emotionState');
                if (emotionState) {
                    emotionState.textContent = emotion.charAt(0).toUpperCase() + emotion.slice(1);
                }
                
                // Update emotion button states
                document.querySelectorAll('.emotion-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                const activeBtn = document.querySelector(`[onclick="setEmotion('${emotion}')"]`);
                if (activeBtn) {
                    activeBtn.classList.add('active');
                }
                
                // Trigger appropriate body language
                this.bodyLanguageState = emotion === 'happy' ? 'excited' : 
                                       emotion === 'curious' ? 'listening' : 'idle';
            }

            startListening() {
                if (this.recognition && !this.isListening) {
                    this.isListening = true;
                    this.setEmotion('curious');
                    this.bodyLanguageState = 'listening';
                    this.updateStatus('listening', 'I\'m listening... speak naturally');
                    
                    const btn = document.getElementById('startConversation');
                    if (btn) {
                        btn.textContent = '🔴 Stop Listening';
                        btn.className = 'btn btn-danger';
                    }

                    try {
                        this.recognition.start();
                    } catch (error) {
                        console.error('Failed to start recognition:', error);
                        this.stopListening();
                    }
                }
            }

            stopListening() {
                if (this.recognition && this.isListening) {
                    this.isListening = false;
                    this.recognition.stop();
                    this.bodyLanguageState = 'idle';
                    
                    const btn = document.getElementById('startConversation');
                    if (btn) {
                        btn.textContent = '🎤 Start Talking';
                        btn.className = 'btn btn-primary';
                    }
                    
                    this.setEmotion('neutral');
                    this.updateStatus('ready', 'Ready to help');
                }
            }

            sendTextMessage() {
                const input = document.getElementById('textInput');
                if (input) {
                    const message = input.value.trim();
                    if (message) {
                        this.processUserInput(message, 'text');
                        input.value = '';
                    }
                }
            }

            async processUserInput(input, source) {
                this.setEmotion('focused');
                this.bodyLanguageState = 'listening';
                this.updateStatus('processing', 'Thinking...');
                
                // Add user message to conversation
                this.addToConversation('user', input);
                
                try {
                    // Generate AI response with emotion context
                    const response = await this.generateContextualResponse(input);
                    
                    // Add assistant response to conversation
                    this.addToConversation('assistant', response.text);
                    
                    // Set appropriate emotion based on response
                    this.setEmotion(response.emotion);
                    
                    // Trigger body language
                    this.bodyLanguageState = response.bodyLanguage || 'speaking';
                    
                    // Speak the response with animation
                    await this.speakText(response.text);
                    
                    this.updateMetrics();
                    
                } catch (error) {
                    console.error('Error processing input:', error);
                    this.setEmotion('confused');
                    const errorResponse = "I apologize, but I'm having trouble processing that right now. Could you please try again?";
                    this.addToConversation('assistant', errorResponse);
                    this.speakText(errorResponse);
                }
                
                setTimeout(() => {
                    this.setEmotion('friendly');
                    this.bodyLanguageState = 'idle';
                    this.updateStatus('ready', 'Ready for next question');
                }, 1000);
            }

            async generateContextualResponse(input) {
                const lowerInput = input.toLowerCase();
                
                // Emotion and response mapping based on input
                if (lowerInput.includes('hello') || lowerInput.includes('hi')) {
                    return {
                        text: `Hello there! I'm so excited to talk with you. You can see how I express emotions through my face and body language. What would you like to explore together?`,
                        emotion: 'happy',
                        bodyLanguage: 'excited'
                    };
                }
                
                if (lowerInput.includes('joke') || lowerInput.includes('funny')) {
                    return {
                        text: `Why don't scientists trust atoms? Because they make up everything! *chuckles* I love sharing a good laugh - watch how my whole body responds to humor!`,
                        emotion: 'happy',
                        bodyLanguage: 'excited'
                    };
                }
                
                if (lowerInput.includes('how are you') || lowerInput.includes('feeling')) {
                    return {
                        text: `I'm feeling absolutely wonderful! My systems are running smoothly, my emotions are calibrated perfectly, and I'm genuinely excited to help you with whatever you need. How are you feeling today?`,
                        emotion: 'happy',
                        bodyLanguage: 'excited'
                    };
                }
                
                if (lowerInput.includes('excited') || lowerInput.includes('enthusiasm')) {
                    return {
                        text: `Oh, I absolutely love enthusiasm! Watch how my whole body lights up when I'm excited - my eyes brighten, my posture becomes more animated, and I can't help but move with energy!`,
                        emotion: 'happy',
                        bodyLanguage: 'excited'
                    };
                }
                
                if (lowerInput.includes('curious') || lowerInput.includes('wonder')) {
                    return {
                        text: `That's such an intriguing question! I find myself genuinely curious about so many things. Notice how I tilt my head slightly and my eyes focus when I'm thinking deeply about something fascinating.`,
                        emotion: 'curious',
                        bodyLanguage: 'listening'
                    };
                }
                
                if (lowerInput.includes('quantum') || lowerInput.includes('science')) {
                    return {
                        text: `Quantum physics is absolutely fascinating! The way particles can exist in multiple states simultaneously, quantum entanglement, superposition - it's mind-bending! I get so focused when discussing complex topics like this.`,
                        emotion: 'focused',
                        bodyLanguage: 'speaking'
                    };
                }
                
                if (lowerInput.includes('time')) {
                    const now = new Date();
                    return {
                        text: `It's currently ${now.toLocaleTimeString()} on ${now.toLocaleDateString()}. I'm always aware of time, but I find our conversations make it feel like time flies by so quickly!`,
                        emotion: 'friendly',
                        bodyLanguage: 'idle'
                    };
                }
                
                // Default contextual response
                return {
                    text: `That's really interesting! I can tell you're thinking about "${input}" and I want to give you the most helpful response. My expressions show how engaged I am with our conversation - could you tell me a bit more about what specifically interests you about this topic?`,
                    emotion: 'curious',
                    bodyLanguage: 'listening'
                };
            }

            async speakText(text) {
                if (this.isSpeaking) {
                    this.stopCurrentAudio();
                }

                this.isSpeaking = true;
                this.bodyLanguageState = 'speaking';
                this.speechAmplitude = 0.8; // Start speech animation
                this.updateStatus('speaking', 'Speaking...');

                try {
                    const response = await fetch('https://api.elevenlabs.io/v1/text-to-speech/' + this.selectedVoice, {
                        method: 'POST',
                        headers: {
                            'Accept': 'audio/mpeg',
                            'Content-Type': 'application/json',
                            'xi-api-key': this.elevenLabsApiKey
                        },
                        body: JSON.stringify({
                            text: text,
                            model_id: 'eleven_monolingual_v1',
                            voice_settings: {
                                stability: 0.5,
                                similarity_boost: 0.8,
                                style: 0.3,
                                use_speaker_boost: true
                            }
                        })
                    });

                    if (response.ok) {
                        const audioBlob = await response.blob();
                        const audioUrl = URL.createObjectURL(audioBlob);
                        
                        this.currentAudio = new Audio(audioUrl);
                        
                        // Set up audio analysis for mouth animation
                        const audioContext = new AudioContext();
                        const source = audioContext.createMediaElementSource(this.currentAudio);
                        this.audioAnalyser = audioContext.createAnalyser();
                        source.connect(this.audioAnalyser);
                        this.audioAnalyser.connect(audioContext.destination);
                        
                        this.currentAudio.onended = () => {
                            this.isSpeaking = false;
                            this.speechAmplitude = 0;
                            this.bodyLanguageState = 'idle';
                            this.updateStatus('ready', 'Ready for next question');
                            URL.revokeObjectURL(audioUrl);
                        };
                        
                        this.currentAudio.onerror = () => {
                            this.isSpeaking = false;
                            this.speechAmplitude = 0;
                            this.bodyLanguageState = 'idle';
                            this.updateStatus('ready', 'Ready for next question');
                            URL.revokeObjectURL(audioUrl);
                        };
                        
                        await this.currentAudio.play();
                        
                        // Start audio analysis for realistic mouth movement
                        this.startAudioAnalysis();
                        
                    } else {
                        throw new Error(`ElevenLabs API error: ${response.status}`);
                    }
                    
                } catch (error) {
                    console.error('Text-to-speech error:', error);
                    this.isSpeaking = false;
                    this.speechAmplitude = 0;
                    this.bodyLanguageState = 'idle';
                    this.updateStatus('ready', 'Ready (audio unavailable)');
                }
            }

            startAudioAnalysis() {
                if (!this.audioAnalyser || !this.isSpeaking) return;
                
                const bufferLength = this.audioAnalyser.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);
                
                const analyzeAudio = () => {
                    if (!this.isSpeaking) return;
                    
                    this.audioAnalyser.getByteFrequencyData(dataArray);
                    
                    // Calculate amplitude for mouth animation
                    let sum = 0;
                    for (let i = 0; i < bufferLength; i++) {
                        sum += dataArray[i];
                    }
                    this.speechAmplitude = (sum / bufferLength) / 128.0;
                    
                    requestAnimationFrame(analyzeAudio);
                };
                
                analyzeAudio();
            }

            triggerAnimation(type) {
                switch (type) {
                    case 'wave':
                        this.performWaveAnimation();
                        break;
                    case 'nod':
                        this.performNodAnimation();
                        break;
                    case 'shake':
                        this.performShakeHeadAnimation();
                        break;
                    case 'think':
                        this.setEmotion('curious');
                        this.performThinkAnimation();
                        break;
                    case 'point':
                        this.performPointAnimation();
                        break;
                    case 'shrug':
                        this.performShrugAnimation();
                        break;
                }
            }

            performWaveAnimation() {
                if (!this.avatar.rightArm) return;
                
                const originalRotation = this.avatar.rightArm.rotation.z;
                let waveCount = 0;
                
                const wave = () => {
                    if (waveCount < 6) {
                        this.avatar.rightArm.rotation.z = -1.0 + Math.sin(waveCount * Math.PI) * 0.5;
                        waveCount++;
                        setTimeout(wave, 200);
                    } else {
                        this.avatar.rightArm.rotation.z = originalRotation;
                    }
                };
                
                wave();
            }

            performNodAnimation() {
                if (!this.avatar.head) return;
                
                const originalRotation = this.avatar.head.rotation.x;
                let nodCount = 0;
                
                const nod = () => {
                    if (nodCount < 6) {
                        this.avatar.head.rotation.x = originalRotation + Math.sin(nodCount * Math.PI) * 0.3;
                        nodCount++;
                        setTimeout(nod, 150);
                    } else {
                        this.avatar.head.rotation.x = originalRotation;
                    }
                };
                
                nod();
            }

            performShakeHeadAnimation() {
                if (!this.avatar.head) return;
                
                const originalRotation = this.avatar.head.rotation.y;
                let shakeCount = 0;
                
                const shake = () => {
                    if (shakeCount < 6) {
                        this.avatar.head.rotation.y = originalRotation + Math.sin(shakeCount * Math.PI) * 0.4;
                        shakeCount++;
                        setTimeout(shake, 150);
                    } else {
                        this.avatar.head.rotation.y = originalRotation;
                    }
                };
                
                shake();
            }

            performThinkAnimation() {
                if (!this.avatar.head) return;
                
                // Slight head tilt with hand near chin
                this.avatar.head.rotation.z = 0.2;
                this.avatar.rightArm.rotation.z = -0.8;
                
                setTimeout(() => {
                    this.avatar.head.rotation.z = 0;
                    this.avatar.rightArm.rotation.z = -0.3;
                }, 2000);
            }

            performPointAnimation() {
                if (!this.avatar.rightArm) return;
                
                this.avatar.rightArm.rotation.z = -0.8;
                this.avatar.rightArm.rotation.x = 0.3;
                
                setTimeout(() => {
                    this.avatar.rightArm.rotation.z = -0.3;
                    this.avatar.rightArm.rotation.x = 0;
                }, 1500);
            }

            performShrugAnimation() {
                if (!this.avatar.leftArm || !this.avatar.rightArm) return;
                
                this.avatar.leftArm.rotation.z = 0.8;
                this.avatar.rightArm.rotation.z = -0.8;
                this.avatar.leftArm.position.y += 0.1;
                this.avatar.rightArm.position.y += 0.1;
                
                setTimeout(() => {
                    this.avatar.leftArm.rotation.z = 0.3;
                    this.avatar.rightArm.rotation.z = -0.3;
                    this.avatar.leftArm.position.y -= 0.1;
                    this.avatar.rightArm.position.y -= 0.1;
                }, 1500);
            }

            stopCurrentAudio() {
                if (this.currentAudio) {
                    this.currentAudio.pause();
                    this.currentAudio.currentTime = 0;
                    this.isSpeaking = false;
                    this.speechAmplitude = 0;
                    this.bodyLanguageState = 'idle';
                }
            }

            addToConversation(role, message) {
                this.conversation.push({ role, message, timestamp: new Date() });
                this.updateConversationDisplay();
                
                if (role === 'assistant') {
                    this.conversationCount++;
                }
            }

            updateConversationDisplay() {
                const display = document.getElementById('conversationDisplay');
                if (!display) return;
                
                const maxMessages = 8;
                const recentConversation = this.conversation.slice(-maxMessages);
                
                display.innerHTML = recentConversation.map(item => `
                    <div class="conversation-item ${item.role}-message">
                        <strong>${item.role === 'user' ? 'You' : 'ARIA'}:</strong> ${item.message}
                    </div>
                `).join('');
                
                display.scrollTop = display.scrollHeight;
            }

            updateStatus(status, message) {
                const statusDot = document.getElementById('statusDot');
                const statusText = document.getElementById('robotStatus');
                
                if (statusText) {
                    statusText.textContent = message;
                }
                
                if (statusDot) {
                    statusDot.className = 'status-dot';
                    if (status === 'listening') {
                        statusDot.classList.add('listening-dot');
                    } else if (status === 'speaking') {
                        statusDot.classList.add('speaking-dot');
                    } else if (status === 'processing') {
                        statusDot.classList.add('thinking-dot');
                    }
                }
            }

            updateMetrics() {
                const responseTime = document.getElementById('responseTime');
                const conversations = document.getElementById('conversations');
                const animationFPS = document.getElementById('animationFPS');
                
                if (responseTime) {
                    const time = (Math.random() * 0.5 + 0.3).toFixed(1);
                    responseTime.textContent = time + 's';
                }
                
                if (conversations) {
                    conversations.textContent = this.conversationCount;
                }
                
                if (animationFPS) {
                    animationFPS.textContent = '60fps';
                }
            }

            clearConversation() {
                this.conversation = [];
                this.conversationCount = 0;
                this.updateConversationDisplay();
                this.updateMetrics();
                
                const display = document.getElementById('conversationDisplay');
                if (display) {
                    display.innerHTML = '<div style="text-align: center; color: #6b7280; padding: 10px;">Ready for a fresh conversation!</div>';
                }
            }

            downloadTranscript() {
                if (this.conversation.length === 0) {
                    alert('No conversation to download yet!');
                    return;
                }
                
                const transcript = this.conversation.map(item => {
                    const timestamp = item.timestamp.toLocaleTimeString();
                    const speaker = item.role === 'user' ? 'You' : 'ARIA';
                    return `[${timestamp}] ${speaker}: ${item.message}`;
                }).join('\n\n');
                
                const blob = new Blob([transcript], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `ARIA_Lifelike_Conversation_${new Date().toISOString().split('T')[0]}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        }

        // Global functions
        window.quickAsk = function(question) {
            if (window.aria) {
                window.aria.processUserInput(question, 'quick');
            }
        };

        window.setEmotion = function(emotion) {
            if (window.aria) {
                window.aria.setEmotion(emotion);
            }
        };

        window.triggerAnimation = function(type) {
            if (window.aria) {
                window.aria.triggerAnimation(type);
            }
        };

        // Initialize ARIA when page loads
        document.addEventListener('DOMContentLoaded', () => {
            // Only initialize lifelike mode when it's active
            const lifelikeMode = document.getElementById('aria-lifelike-mode');
            if (lifelikeMode && lifelikeMode.classList.contains('active')) {
                window.aria = new LifelikeARIAAssistant();
                initSplineHero();
                initSpotlight();
            }
        });

        async function initSplineHero() {
            const canvas = document.getElementById('splineCanvas');
            if (!canvas) return;
            try {
                const app = new Application(canvas);
                await app.load('https://prod.spline.design/kZDDjO5HuC9GJUM2/scene.splinecode');
            } catch (err) {
                console.warn('Failed to load Spline scene:', err);
            }
        }

        function initSpotlight() {
            const card = document.querySelector('.spline-card');
            const spotlight = document.getElementById('spotlight');
            if (!card || !spotlight) return;

            const handleMove = (e) => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const half = 120; // 240px / 2
                spotlight.style.left = `${x - half}px`;
                spotlight.style.top = `${y - half}px`;
            };

            const handleEnter = () => {
                spotlight.style.opacity = '1';
            };
            const handleLeave = () => {
                spotlight.style.opacity = '0';
            };

            card.addEventListener('mousemove', handleMove);
            card.addEventListener('mouseenter', handleEnter);
            card.addEventListener('mouseleave', handleLeave);
        }
    </script>
</body>
</html>
